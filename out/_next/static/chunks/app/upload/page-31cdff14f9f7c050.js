(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[676],{5867:function(e,s,a){Promise.resolve().then(a.bind(a,3844))},812:function(e,s,a){"use strict";a.r(s),a.d(s,{default:function(){return o}});var r=a(3827),t=a(8792),n=a(7907),l=a(2382);function o(){let{user:e,logout:s}=(0,l.useAuth)(),a=(0,n.useRouter)();return(0,r.jsx)("header",{className:"main-header",children:(0,r.jsxs)("div",{className:"container header-container",children:[(0,r.jsxs)("div",{className:"flex items-center gap-4",children:[(0,r.jsx)("button",{onClick:()=>a.back(),className:"w-8 h-8 flex items-center justify-center rounded-full bg-gray-100 hover:bg-gray-200 text-gray-600 transition-colors",title:"Go Back",children:(0,r.jsx)("i",{className:"fa-solid fa-arrow-left"})}),(0,r.jsxs)(t.default,{href:"/",className:"logo",children:[(0,r.jsx)("i",{className:"fa-solid fa-brain"}),(0,r.jsxs)("div",{className:"logo-text",children:[(0,r.jsx)("span",{children:"The"}),(0,r.jsx)("strong",{children:"Brainiacs"})]})]})]}),(0,r.jsxs)("div",{className:"search-bar",children:[(0,r.jsx)("i",{className:"fa-solid fa-magnifying-glass"}),(0,r.jsx)("input",{type:"text",placeholder:"Search coupons, brands..."})]}),(0,r.jsxs)("div",{className:"nav-icons",children:[(0,r.jsx)(t.default,{href:e?"/dashboard":"/login",className:"icon-btn highlight",title:e?"Dashboard":"Login",children:(0,r.jsx)("i",{className:"fa-regular ".concat(e?"fa-id-badge":"fa-user")})}),(0,r.jsx)("a",{href:"#",className:"icon-btn",children:(0,r.jsx)("i",{className:"fa-solid fa-cart-shopping"})}),(0,r.jsx)("a",{href:"#",className:"icon-btn",children:(0,r.jsx)("i",{className:"fa-regular fa-bell"})}),e&&(0,r.jsx)("button",{onClick:s,className:"icon-btn text-red-500",title:"Logout",children:(0,r.jsx)("i",{className:"fa-solid fa-right-from-bracket"})})]})]})})}},3844:function(e,s,a){"use strict";a.r(s),a.d(s,{default:function(){return c}});var r=a(3827),t=a(4090),n=a(135),l=a(7907),o=a(2382),i=a(812);function c(){let e=(0,l.useRouter)(),{user:s}=(0,o.useAuth)(),[a,c]=(0,t.useState)(!1),[d,u]=(0,t.useState)(!1),[h,m]=(0,t.useState)(null),[f,x]=(0,t.useState)({brand_name:"",category:"",code:"",description:"",expiry_date:new Date().toISOString().split("T")[0]}),[p,g]=(0,t.useState)(null),j=e=>{x({...f,[e.target.name]:e.target.value}),"code"===e.target.name&&m(null)},v=async()=>{if(!p||!f.code)return;u(!0),m(null);let e=new FormData;e.append("file",p),e.append("expectedCode",f.code);try{let s=await fetch("/api/verify-coupon",{method:"POST",body:e}),a=await s.json();m({success:a.success,message:a.message})}catch(e){console.error("Verification failed",e),m({success:!1,message:"Verification failed. Please try again."})}finally{u(!1)}},b=async a=>{if(a.preventDefault(),!s){alert("You must be logged in to upload a coupon."),e.push("/login");return}if(!h||!h.success){alert("Please verify the coupon with AI before uploading.");return}c(!0);try{let a=null;if(p){let e=p.name.split(".").pop(),s="".concat(Math.random(),".").concat(e),{data:r,error:t}=await n.O.storage.from("coupons").upload(s,p);!t&&r?a=r.path:console.warn("Image upload failed or bucket missing, proceeding without image:",t)}let{error:r}=await n.O.from("coupons").insert([{brand_name:f.brand_name,category:f.category,code:f.code,description:f.description,expiry_date:f.expiry_date,image_url:a,seller_id:s.id,status:"available"}]);if(r)throw r;alert("Coupon uploaded successfully!"),e.push("/marketplace")}catch(e){console.error("Error uploading coupon:",e),alert("Failed to upload coupon: "+e.message)}finally{c(!1)}};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(i.default,{}),(0,r.jsx)("section",{className:"upload-section",children:(0,r.jsx)("div",{className:"container",children:(0,r.jsxs)("div",{className:"form-container",children:[(0,r.jsx)("h2",{children:"Upload Coupon"}),(0,r.jsxs)("form",{onSubmit:b,children:[(0,r.jsxs)("div",{className:"form-group",children:[(0,r.jsx)("label",{children:"Brand Name *"}),(0,r.jsxs)("select",{name:"brand_name",className:"form-control red-outline",value:f.brand_name,onChange:j,required:!0,children:[(0,r.jsx)("option",{value:"",children:"Select Brand"}),(0,r.jsx)("option",{value:"Amazon",children:"Amazon"}),(0,r.jsx)("option",{value:"Flipkart",children:"Flipkart"}),(0,r.jsx)("option",{value:"Zomato",children:"Zomato"}),(0,r.jsx)("option",{value:"Swiggy",children:"Swiggy"}),(0,r.jsx)("option",{value:"Swiggy Instamart",children:"Swiggy Instamart"}),(0,r.jsx)("option",{value:"Myntra",children:"Myntra"}),(0,r.jsx)("option",{value:"Ajio",children:"Ajio"}),(0,r.jsx)("option",{value:"Giva",children:"Giva"}),(0,r.jsx)("option",{value:"Lenskart",children:"Lenskart"}),(0,r.jsx)("option",{value:"Uber",children:"Uber"})]})]}),(0,r.jsxs)("div",{className:"form-group",children:[(0,r.jsx)("label",{children:"Category *"}),(0,r.jsxs)("select",{name:"category",className:"form-control red-outline",value:f.category,onChange:j,required:!0,children:[(0,r.jsx)("option",{value:"",children:"Select Category"}),(0,r.jsx)("option",{value:"Food",children:"Food"}),(0,r.jsx)("option",{value:"Fashion",children:"Fashion"}),(0,r.jsx)("option",{value:"Travel",children:"Travel"}),(0,r.jsx)("option",{value:"Electronics",children:"Electronics"}),(0,r.jsx)("option",{value:"Grocery",children:"Grocery"})]})]}),(0,r.jsxs)("div",{className:"form-group",children:[(0,r.jsx)("label",{children:"Coupon Code *"}),(0,r.jsx)("input",{type:"text",name:"code",className:"form-control",placeholder:"Enter coupon code",value:f.code,onChange:j,required:!0})]}),(0,r.jsxs)("div",{className:"form-group",children:[(0,r.jsx)("label",{children:"Description *"}),(0,r.jsx)("textarea",{name:"description",className:"form-control",rows:"3",placeholder:"e.g., 15% off on â‚¹3000 cart value",value:f.description,onChange:j,required:!0})]}),(0,r.jsxs)("div",{className:"form-group",children:[(0,r.jsx)("label",{children:"Expiry Date *"}),(0,r.jsx)("input",{type:"date",name:"expiry_date",className:"form-control red-outline text-center",value:f.expiry_date,onChange:j,required:!0})]}),(0,r.jsxs)("div",{className:"form-group",children:[(0,r.jsx)("label",{children:"Coupon Screenshot (Required for Verification) *"}),(0,r.jsxs)("div",{className:"file-upload-box red-outline ".concat((null==h?void 0:h.success)?"bg-green-50 border-green-500":""),children:[(0,r.jsx)("input",{type:"file",id:"file-upload",hidden:!0,onChange:e=>{e.target.files&&e.target.files[0]&&(g(e.target.files[0]),m(null))},required:!0}),(0,r.jsxs)("label",{htmlFor:"file-upload",className:"cursor-pointer block text-center",children:[(0,r.jsx)("i",{className:"fa-solid ".concat((null==h?void 0:h.success)?"fa-check-circle text-green-600":"fa-camera")}),p?p.name:" Upload Image"]})]}),p&&f.code&&!(null==h?void 0:h.success)&&(0,r.jsx)("div",{className:"mt-2 text-center",children:(0,r.jsx)("button",{type:"button",onClick:v,disabled:d,className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 text-sm",children:d?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("i",{className:"fa-solid fa-spinner fa-spin"})," Verifying..."]}):"Verify with AI"})}),h&&(0,r.jsxs)("div",{className:"mt-2 p-2 rounded text-sm text-center ".concat(h.success?"text-green-700 bg-green-100":"text-red-700 bg-red-100"),children:[h.message,!h.success&&(0,r.jsx)("p",{className:"text-xs mt-1",children:"Please ensure the code in the image matches the code entered."})]})]}),(0,r.jsxs)("div",{className:"form-submit",children:[(0,r.jsx)("button",{type:"submit",className:"btn btn-primary full-width ".concat((null==h?void 0:h.success)?"":"opacity-50 cursor-not-allowed"),disabled:a||!(null==h?void 0:h.success),children:a?"Uploading...":"Upload Verified Coupon"}),!(null==h?void 0:h.success)&&(0,r.jsx)("p",{className:"text-xs text-center text-gray-500 mt-2",children:"AI Verification is required before upload."})]})]})]})})}),(0,r.jsx)("footer",{className:"main-footer",children:(0,r.jsxs)("div",{className:"container footer-container",children:[(0,r.jsxs)("div",{className:"footer-left",children:[(0,r.jsx)("h4",{children:"The Brainiacs - Coupon Marketplace"}),(0,r.jsx)("p",{children:"Save money on your favorite brands"}),(0,r.jsx)("p",{className:"phone",children:"\xa9 2026 The Brainiacs. All rights reserved."})]}),(0,r.jsxs)("div",{className:"footer-right",children:[(0,r.jsx)("a",{href:"#",children:"Terms"}),(0,r.jsx)("a",{href:"#",children:"Privacy"}),(0,r.jsx)("a",{href:"#",children:"Contact Us"}),(0,r.jsx)("a",{href:"#",className:"footer-icon",children:(0,r.jsx)("i",{className:"fa-brands fa-instagram"})}),(0,r.jsx)("div",{className:"footer-btn",children:"Don't!"})]})]})})]})}},2382:function(e,s,a){"use strict";a.r(s),a.d(s,{AuthProvider:function(){return i},useAuth:function(){return c}});var r=a(3827),t=a(4090),n=a(135),l=a(7907);let o=(0,t.createContext)();function i(e){let{children:s}=e,[a,i]=(0,t.useState)(null),[c,d]=(0,t.useState)(!0),u=(0,l.useRouter)();(0,t.useEffect)(()=>{let e=localStorage.getItem("user_id");e?h(e):d(!1)},[]);let h=async e=>{try{let{data:s,error:a}=await n.O.from("users").select("*").eq("id",e).single();if(a)throw a;s&&i(s)}catch(e){console.error("Error fetching user:",e),localStorage.removeItem("user_id")}finally{d(!1)}},m=async e=>{d(!0);try{let{data:s,error:a}=await n.O.from("users").select("*").eq("phone_number",e).single();if(!s)return d(!1),{success:!1,status:"USER_NOT_FOUND"};return i(s),localStorage.setItem("user_id",s.id),{success:!0,user:s}}catch(e){return console.error("Login Error:",e),{success:!1,error:e}}finally{d(!1)}},f=async e=>{d(!0);try{let{data:s,error:a}=await n.O.from("users").insert([e]).select().single();if(a)throw a;return i(s),localStorage.setItem("user_id",s.id),{success:!0,user:s}}catch(e){return console.error("Registration Error:",e),{success:!1,error:e}}finally{d(!1)}};return(0,r.jsx)(o.Provider,{value:{user:a,loading:c,loginWithPhone:m,registerUser:f,logout:()=>{i(null),localStorage.removeItem("user_id"),u.push("/login")}},children:s})}let c=()=>(0,t.useContext)(o)},135:function(e,s,a){"use strict";a.d(s,{O:function(){return l}});var r=a(7688);let t="https://zlpjahdoxdbjzpvxuosp.supabase.co",n="sb_publishable_dqwGMGOwDlbN79ObqqM8gg_mRKsxNcu";if(!t||!n)throw Error("Missing Supabase environment variables");let l=(0,r.eI)(t,n)}},function(e){e.O(0,[436,792,971,69,744],function(){return e(e.s=5867)}),_N_E=e.O()}]);